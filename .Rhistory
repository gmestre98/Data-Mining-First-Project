#install.packages("e1071")
#if(!require("devtools")) {
#  install.packages("devtools")
#  library("devtools")
#}
#devtools::install_github("mdscheuerell/muti")
# Calling the necessary Libraries
library(ggplot2)
library(e1071)
library(DataExplorer)
library(corrplot)
library(RColorBrewer)
library("muti")
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36])
corrplot(corvar, method="color", col = brewer.pal(n = 8, name = "RdBu"), type="lower", tl.col = "black",
addCoef.col = "black", tl.srt = 15, tl.cex = 0.6, number.cex = 0.7)
muti(train_data)
?muti
devtools::install_github("pohlio/tidyinftheo")
devtools::install_github("pohlio/tidyinftheo")
?tibble
devtools::install_github("pohlio/tidyinftheo")
library(tidyinftheo)
library(infotheo)
?infotheo
install.packages("tibble")
install.packages("tibble")
library(tidyinftheo)
devtools::install_github("pohlio/tidyinftheo")
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 1:37, normalized=TRUE)
library(tidyinftheo)
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 1:37, normalized=TRUE)
mutual_info_heatmap(mutinf, font_sizes = c(9,9))
lifecycle::last_warnings()
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 1:37)
mutual_info_heatmap(mutinf, font_sizes = c(9,9))
View(train_data)
mutinf
muti(train_data[, 1], train_data[,2])
library(muti)
muti(train_data[, 1], train_data[,2])
muti(train_data[, 7], train_data[,8])
muti(train_data[, 1], train_data[,2])
a <- muti(train_data[, 7], train_data[,8])
mutinf$MI
?mutinf
?mutual_info_matrix
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 1:37, normalized = TRUE)
mutual_info_heatmap(mutinf, font_sizes = c(9,9))
mutual_info_heatmap(mutinf, font_sizes = c(9,9))
?mutual_info_heatmap
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 6:17, normalized = TRUE)
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 6:17)
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 10:17)
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 1:17)
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 1
2:17)
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 1
5:17)
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 4:17)
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 34:37)
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 1:37)
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
mutinf$MI
boxplot.matrix(train_data)
boxplot.matrix(train_data[,6])
boxplot.matrix(train_data[,6:37])
boxplot.matrix(train_data[,6:7])
X<-iris[1:50,1:4]###Setosas - Iris -
set.seed(1738)
X1000<-rmvnorm(n,colMeans(X), cov(X))
library(mvtnorm)
X<-iris[1:50,1:4]###Setosas - Iris -
set.seed(1738)
X1000<-rmvnorm(n,colMeans(X), cov(X))
n=1000
X<-iris[1:50,1:4]###Setosas - Iris -
set.seed(1738)
X1000<-rmvnorm(n,colMeans(X), cov(X))
boxplot.matrix(X1000)
boxplot(train_data[,1])
boxplot(train_data[,6])
boxplot(train_data[,7])
boxplot(train_data[,10])
# Visualizing Box plots for each variable
for (i in 7:36){
boxplot(train_data[,i])
}
# Visualizing Box plots for each variable
for (i in 7:36){
boxplot(train_data[,i], col=rgb(0.3,0.5,0.4,0.6), las=2, cex.axis=0.70)
}
require(reshape2)
df.m <- melt(train_data[,7:36], id.var = "Label")
> df.m # pasting some rows of the melted data.frame
require(ggplot2)
ggplot(data = df.m, aes(x=variable, y=value)) + geom_boxplot(aes(fill=Label))
df.m <- melt(train_data[,7:36], id.var = train_data[,37])
df.m <- melt(train_data[,7:36], id.var = train_data[,37])
> df.m # pasting some rows of the melted data.frame
require(ggplot2)
ggplot(data = train_data[,6:37], aes(x=variable, y=value)) + geom_boxplot(aes(fill=Label))
ggplot(data = train_data[,7:36], aes(x=variable, y=value)))
ggplot(data = train_data[,7:36], aes(x=variable, y=value))
ggplot(data = train_data[,7:36])
for (i in 7:36){
boxplot(train_data[,i], col=rgb(0.3,0.5,0.4,0.6), las=2, cex.axis=0.70)
}
plotti <- data[c(7,36)]
plotti <- data[, 7:36]
plotti <- data[,7:36]
plotti <- train_data[c(7,36)]
boxplot(plotti, col=rgb(0.3,0.5,0.4,0.6),las=1, ylim = c(0, 400),cex.axis=0.70)
plotti <- train_data[c(7:36)]
boxplot(plotti, col=rgb(0.3,0.5,0.4,0.6),las=1, ylim = c(0, 400),cex.axis=0.70)
plotti <- train_data[c(17:26)]
boxplot(plotti, col=rgb(0.3,0.5,0.4,0.6),las=1, ylim = c(0, 400),cex.axis=0.70)
plotti <- train_data[c(27:36)]
boxplot(plotti, col=rgb(0.3,0.5,0.4,0.6),las=1, ylim = c(0, 400),cex.axis=0.70)
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36])
corrplot(corvar, method="color", col = brewer.pal(n = 8, name = "RdBu"), type="lower", tl.col = "black",
addCoef.col = "black", tl.srt = 15, tl.cex = 0.6, number.cex = 0.7)
# Checking the data
head(train_data)
v <-sapply(train_data[7:36], var)
m <-sapply(train_data[7:36], mean)
q <-sapply(train_data[7:36], quantile)
i <-sapply(train_data[7:36], IQR)
s <-sapply(train_data[7:36], skewness)
k <-sapply(train_data[7:36], kurtosis)
library(e1071)
s <-sapply(train_data[7:36], skewness)
k <-sapply(train_data[7:36], kurtosis)
v
# Plotting histograms of each variable, and signaling the class for each data
class1 <- data.frame(V34 = train_data[train_data[37]=='_1_', 16])
class0 <- data.frame(V34 = train_data[train_data[37]=='_0_', 16])
class1$Class <- 'Class 1'
class0$Class <- 'Class 0'
classCounts <- rbind(class1, class0)
ggplot(classCounts, aes(V34, fill = Class)) +
geom_histogram(alpha = 0.5, aes(y = ..count..), position = 'identity', bins = 100)
boxplot(train_data[,16], col=rgb(0.3,0.5,0.4,0.6), las=2, cex.axis=0.70)
boxplot(log(train_data[,16]), col=rgb(0.3,0.5,0.4,0.6), las=2, cex.axis=0.70)
boxplot(train_data[,16]/var(train_data[,16]), col=rgb(0.3,0.5,0.4,0.6), las=2, cex.axis=0.70)
boxplot(log(train_data[,16]/sd(train_data[,16])), col=rgb(0.3,0.5,0.4,0.6), las=2, cex.axis=0.70)
descriptive <- data.frame("mean" = m, "variance" = v, "minimum" = q[1,], "Q1" = q[2,], "median" = q[2,],
"Q3" = q[3,], "max" = q[4,], "IQR" = i, "skewness" = s, "kurtosis" = k)
dsecriptive
descriptive
m1 <- sapply(train_data[7:36], max)
m0 <- sapply(train_data[7:36], min)
descriptive <- data.frame("mean" = m, "variance" = v, "minimum" = m0, "Q1" = q[2,], "median" = q[2,],
"Q3" = q[3,], "max" = m1, "IQR" = i, "skewness" = s, "kurtosis" = k)
descriptivre
descriptive
boxplot(train_data[,12], col=rgb(0.3,0.5,0.4,0.6), las=2, cex.axis=0.70)
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36])
corrplot(corvar, method="color", col = brewer.pal(n = 8, name = "RdBu"), type="lower", tl.col = "black",
addCoef.col = "black", tl.srt = 15, tl.cex = 0.6, number.cex = 0.7)
library(corrplot)
corvar <- cor(train_data[7:36])
corrplot(corvar, method="color", col = brewer.pal(n = 8, name = "RdBu"), type="lower", tl.col = "black",
addCoef.col = "black", tl.srt = 15, tl.cex = 0.6, number.cex = 0.7)
library(ggplot2)
library(e1071)
library(DataExplorer)
library(corrplot)
library(RColorBrewer)
library(tidyinftheo)
library("muti")
corvar <- cor(train_data[7:36])
corrplot(corvar, method="color", col = brewer.pal(n = 8, name = "RdBu"), type="lower", tl.col = "black",
addCoef.col = "black", tl.srt = 15, tl.cex = 0.6, number.cex = 0.7)
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:37])
corrplot(corvar, method="color", col = brewer.pal(n = 8, name = "RdBu"), type="lower", tl.col = "black",
addCoef.col = "black", tl.srt = 15, tl.cex = 0.6, number.cex = 0.7)
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36])
corrplot(corvar, method="color", col = brewer.pal(n = 8, name = "RdBu"), type="lower", tl.col = "black",
addCoef.col = "black", tl.srt = 15, tl.cex = 0.6, number.cex = 0.7)
mutinf <- mutual_info_matrix(train_data, 1:37)
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
mutinf$MI
# Computing the Mutual Information between each variable
mutinf <- mutual_info_matrix(train_data, 1:37, normalized=TRUE)
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
mutinf$MI
mt_tib <- as_tibble(train_data) %>% mutate_all(as.character)
mutual_info_matrix(mt_tib, 7:37)
mt_tib <- as_tibble(train_data) %>% mutate_all(as.character)
mutual_info_matrix(mt_tib, c(1,2,3,4,5,6,37))
library(ggplot2)
library(e1071)
library(DataExplorer)
library(corrplot)
library(RColorBrewer)
library(tidyinftheo)
library("muti")
options(warn = FALSE)
train_data <- try(read.table("Input/client_train.txt"))
if (class(train_data) == "try-error") {
folder = "Input/"
file = "client_train.txt"
cat("Downloading the data instead.")
dir.create(folder)
train_data <- read.table("http://web.tecnico.ulisboa.pt/~ist13493/MEDM2020/Project1/Group3Data/client_train.txt")
write.table(train_data, file=paste(folder, file, sep=''), append = FALSE, sep = " ", dec = ".",
row.names = FALSE, col.names = FALSE)
}
test_data <- try(read.table("Input/client_test_marked.txt"))
if (class(train_data) == "try-error") {
file = "client_test_marked.txt"
print("Downloading the data instead.")
train_data <- read.table("http://web.tecnico.ulisboa.pt/~ist13493/MEDM2020/Project1/Group3Data/client_test_marked.txt")
write.table(train_data, file=paste(folder, file, sep=''), append = FALSE, sep = " ", dec = ".",
row.names = FALSE, col.names = FALSE)
}
options(warn = TRUE)
# Cleaning the categorical data
train_data[,1] <- substr(train_data[,1], 2, 2)
train_data[,2] <- substr(train_data[,2], 2, 2)
unique(train_data[,3])
options(warn = FALSE)
for (i in 1:12000){
train_data[i,3] <- substr(train_data[i,3], 2, length(train_data[i,3])-1)
#train_data[i,4] <- substr(train_data[,4], 2, length(train_data[i,4])-1)
#train_data[i,5] <- substr(train_data[,5], 2, length(train_data[i,5])-1)
#train_data[i,6] <- substr(train_data[,6], 2, length(train_data[i,6])-1)
}
options(warn = TRUE)
unique(train_data[,3])
length(train_data[1,3])
train_data[1,3]
View(train_data)
options(warn = FALSE)
train_data <- try(read.table("Input/client_train.txt"))
if (class(train_data) == "try-error") {
folder = "Input/"
file = "client_train.txt"
cat("Downloading the data instead.")
dir.create(folder)
train_data <- read.table("http://web.tecnico.ulisboa.pt/~ist13493/MEDM2020/Project1/Group3Data/client_train.txt")
write.table(train_data, file=paste(folder, file, sep=''), append = FALSE, sep = " ", dec = ".",
row.names = FALSE, col.names = FALSE)
}
test_data <- try(read.table("Input/client_test_marked.txt"))
if (class(train_data) == "try-error") {
file = "client_test_marked.txt"
print("Downloading the data instead.")
train_data <- read.table("http://web.tecnico.ulisboa.pt/~ist13493/MEDM2020/Project1/Group3Data/client_test_marked.txt")
write.table(train_data, file=paste(folder, file, sep=''), append = FALSE, sep = " ", dec = ".",
row.names = FALSE, col.names = FALSE)
}
options(warn = TRUE)
View(train_data)
length(train_data[1,3])
length(train_data[1,3])
library(reticulate)
use_python("/usr/local/bin/python")
py_install("scikit-learn")
#py_install("scikit-learn")
sklearn <- import("sklearn.feature_selection")
mutinf <- sklearn$mutual_info_classif(as.matrix(train_data[,1:36]), train_data[,37], discrete_features=c(1,6))
mutinf <- sklearn$mutual_info_classif(as.matrix(train_data[,1:36]), train_data[,37], discrete_features=c(1:6))
unique(train_data[,3])
train_data[,3] <- as.numeric(train_data[,3])
unique(train_data[,3])
train_data[,1] <- as.factor(as.numeric(train_data[,1]))
train_data[,2] <- as.factor(as.numeric(train_data[,2]))
train_data[,3] <- as.factor(as.numeric(train_data[,3]))
train_data[,4] <- as.factor(as.numeric(train_data[,4]))
train_data[,5] <- as.factor(as.numeric(train_data[,5]))
train_data[,6] <- as.factor(as.numeric(train_data[,6]))
train_data[,37] <- as.factor(as.numeric(train_data[,37]))
unique(train_data[,3])
v <-sapply(train_data[,7:36], var)
m <-sapply(train_data[,7:36], mean)
q <-sapply(train_data[,7:36], quantile)
m0 <- sapply(train_data[,7:36], min)
m1 <- sapply(train_data[,7:36], max)
i <-sapply(train_data[,7:36], IQR)
s <-sapply(train_data[,7:36], skewness)
k <-sapply(train_data[,7:36], kurtosis)
descriptive <- data.frame("mean" = m, "variance" = v, "minimum" = m0, "Q1" = q[2,], "median" = q[2,],
"Q3" = q[3,], "max" = m1, "IQR" = i, "skewness" = s, "kurtosis" = k)
show = TRUE
if(show){
descriptive
} else {
folder = "Output/"
file = "descriptive.csv"
suppressWarnings(dir.create(folder))
write.csv(descriptive, file = paste(path, file, sep = ''))
}
# Trying some transformations on low variance columns to indetify why it has a low variance
var(log(train_data[,22]) + 1)
source('~/Tecnico/MestreMEEC/Mestrado/2 semestre/MEDM/Data-Mining-First-Project/Exploratory_train.R', encoding = 'UTF-8', echo=TRUE)
# Plotting histograms of each variable, and signaling the class for each data
i=8
class1 <- data.frame(V = train_data[train_data[37]=='2', i])
class0 <- data.frame(V = train_data[train_data[37]=='1', i])
class1$Class <- 'Class 1'
class0$Class <- 'Class 0'
classCounts <- rbind(class1, class0)
ggplot(classCounts, aes(V, fill = Class)) +
geom_histogram(alpha = 0.5, aes(y = ..count..), position = 'identity', bins = 100)
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36])
corrplot(corvar, method="color", col = brewer.pal(n = 8, name = "RdBu"), type="lower", tl.col = "black",
addCoef.col = "black", tl.srt = 15, tl.cex = 0.6, number.cex = 0.7)
#install.packages("reticulate")
library(reticulate)
use_python("/usr/local/bin/python")
#py_install("scikit-learn")
sklearn1 <- import("sklearn.feature_selection")
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:36]), train_data[,37], discrete_features=c(1:6))
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
mutual_info_heatmap(mutinf, font_sizes = c(12,12))
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:37]), train_data[,1:37], discrete_features=c(1:6))
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:37]), train_data[,1:37], discrete_features=c(1:6,37))
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:37]), train_data[,1:37], discrete_features=c(1,2,3,4,5,6,37))
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:37]), train_data[,2:37], discrete_features=c(1,2,3,4,5,6,37))
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:37]), as.matrix(train_data[,1:37]), discrete_features=c(1,2,3,4,5,6,37))
for (i in 1:37){
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:37]), as.matrix(train_data[,i]), discrete_features=c(1,2,3,4,5,6,37))
}
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:37]), as.matrix(train_data[,37]), discrete_features=c(1,2,3,4,5,6,37))
mutinf
for (i in 1:37){
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:37]), train_data[,i], discrete_features=c(1,2,3,4,5,6,37))
}
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:37]), train_data[,1], discrete_features=c(1,2,3,4,5,6,37))
mutinf <- sklearn1$mutual_info_classif(as.matrix(train_data[,1:37]), train_data[,37], discrete_features=c(1:6))
mutinf
mutinf <- sklearn1$mutual_info_classif(train_data[,1:37], train_data[,37], discrete_features=c(1:6))
mm1 <- as.matrix(train_data)
mm2 <- matrix(train_data, dimnames = NULL)
mutinf <- sklearn1$mutual_info_classif(mm2[,1], train_data[,37], discrete_features=c(1:6))
View(mm2)
View(mm2)
mutinf <- sklearn1$mutual_info_classif(mm2[,1], mm2[,37], discrete_features=c(1:6))
mutinf <- sklearn1$mutual_info_classif(mm2[,0], mm2[,36], discrete_features=c(1:6))
mm2
mutinf <- sklearn1$mutual_info_classif(mm2[1,], mm2[37,], discrete_features=c(1:6))
mutinf <- sklearn1$mutual_info_classif(mm2, mm2[37,], discrete_features=c(1:6))
mm1 <- as.matrix(train_data, dimnames=NULL)
mutinf <- sklearn1$mutual_info_classif(mm1, mm1[37,], discrete_features=c(1:6))
mutinf <- sklearn1$mutual_info_classif(mm1, mm1[,37], discrete_features=c(1:6))
mutinf
library(ggplot2)
library(e1071)
library(DataExplorer)
library(corrplot)
library(RColorBrewer)
library(tidyinftheo)
library("muti")
# Loading data
options(warn = FALSE)
train_data <- try(read.table("Input/client_train.txt"))
if (class(train_data) == "try-error") {
folder = "Input/"
file = "client_train.txt"
cat("Downloading the data instead.")
dir.create(folder)
train_data <- read.table("http://web.tecnico.ulisboa.pt/~ist13493/MEDM2020/Project1/Group3Data/client_train.txt")
write.table(train_data, file=paste(folder, file, sep=''), append = FALSE, sep = " ", dec = ".",
row.names = FALSE, col.names = FALSE)
}
test_data <- try(read.table("Input/client_test_marked.txt"))
if (class(train_data) == "try-error") {
file = "client_test_marked.txt"
print("Downloading the data instead.")
train_data <- read.table("http://web.tecnico.ulisboa.pt/~ist13493/MEDM2020/Project1/Group3Data/client_test_marked.txt")
write.table(train_data, file=paste(folder, file, sep=''), append = FALSE, sep = " ", dec = ".",
row.names = FALSE, col.names = FALSE)
}
options(warn = TRUE)
# Checking the data
head(train_data)
# Cleaning the categorical data
train_data[,1] <- as.factor(as.numeric(train_data[,1]) - 1)
train_data[,2] <- as.factor(as.numeric(train_data[,2]) - 1)
train_data[,3] <- as.factor(as.numeric(train_data[,3]) - 1)
train_data[,4] <- as.factor(as.numeric(train_data[,4]) - 1)
train_data[,5] <- as.factor(as.numeric(train_data[,5]) - 1)
train_data[,6] <- as.factor(as.numeric(train_data[,6]) - 1)
train_data[,37] <- as.factor(as.numeric(train_data[,37]) - 1)
mm1 <- as.matrix(train_data, dimnames=NULL)
mutinf <- sklearn1$mutual_info_classif(mm1, mm1[,37], discrete_features=c(1:6))
mutinf <- sklearn1$mutual_info_classif(mm1, mm1[,37], discrete_features=c(1:6))
mutinf
mutinf <- sklearn1$mutual_info_classif(train_data, train_data[,7:37], discrete_features=c(1:6))
# Computing the mutual information using python
mutinf <- sklearn1$mutual_info_classif(train_data, train_data[,1:37], discrete_features=c(1:6))
# Computing the mutual information using python
mutinf <- sklearn1$mutual_info_classif(train_data, train_data, )
# Computing the mutual information using python
mutinf <- sklearn1$mutual_info_classif(train_data, train_data)
train_data <- as.matrix(train_data, dimnames=NULL)
# Computing the mutual information using python
mutinf <- sklearn1$mutual_info_classif(train_data, train_data)
# Computing the mutual information using python
mutinf <- sklearn1$mutual_info_classif(train_data, train_data[,1])
mutinf
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36])
corrplot(corvar, method="color", col = brewer.pal(n = 8, name = "RdBu"), type="lower", tl.col = "black",
addCoef.col = "black", tl.srt = 15, tl.cex = 0.6, number.cex = 0.7)
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[,7:36])
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36,])
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36,:])
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36,1:12000])
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[1:12000,7:36])
?cor
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36])
# Necessary Package Installation
#install.packages("DataExplorer")
#install.packages("corrplot")
#install.packages("tidyinftheo")
#install.packages("ggplot2")
#install.packages("e1071")
#devtools::install_github("pohlio/tidyinftheo")
#if(!require("devtools")) {
#  install.packages("devtools")
#  library("devtools")
#}
#devtools::install_github("mdscheuerell/muti")
# Calling the necessary Libraries
library(ggplot2)
library(e1071)
library(DataExplorer)
library(corrplot)
library(RColorBrewer)
library(tidyinftheo)
library("muti")
#install.packages("reticulate")
library(reticulate)
use_python("/usr/local/bin/python")
#py_install("scikit-learn")
sklearn1 <- import("sklearn.feature_selection")
sklearn2 <- import("sklearn.preprocessing")
# Loading data
options(warn = FALSE)
train_data <- try(read.table("Input/client_train.txt"))
if (class(train_data) == "try-error") {
folder = "Input/"
file = "client_train.txt"
cat("Downloading the data instead.")
dir.create(folder)
train_data <- read.table("http://web.tecnico.ulisboa.pt/~ist13493/MEDM2020/Project1/Group3Data/client_train.txt")
write.table(train_data, file=paste(folder, file, sep=''), append = FALSE, sep = " ", dec = ".",
row.names = FALSE, col.names = FALSE)
}
test_data <- try(read.table("Input/client_test_marked.txt"))
if (class(train_data) == "try-error") {
file = "client_test_marked.txt"
print("Downloading the data instead.")
train_data <- read.table("http://web.tecnico.ulisboa.pt/~ist13493/MEDM2020/Project1/Group3Data/client_test_marked.txt")
write.table(train_data, file=paste(folder, file, sep=''), append = FALSE, sep = " ", dec = ".",
row.names = FALSE, col.names = FALSE)
}
options(warn = TRUE)
# Checking the data
head(train_data)
# Cleaning the data
train_data[,1] <- as.factor(as.numeric(train_data[,1]) - 1)
train_data[,2] <- as.factor(as.numeric(train_data[,2]) - 1)
train_data[,3] <- as.factor(as.numeric(train_data[,3]) - 1)
train_data[,4] <- as.factor(as.numeric(train_data[,4]) - 1)
train_data[,5] <- as.factor(as.numeric(train_data[,5]) - 1)
train_data[,6] <- as.factor(as.numeric(train_data[,6]) - 1)
train_data[,37] <- as.factor(as.numeric(train_data[,37]) - 1)
# Computing the correlations and plotting the correlogram
corvar <- cor(train_data[7:36])
corrplot(corvar, method="color", col = brewer.pal(n = 8, name = "RdBu"), type="lower", tl.col = "black",
addCoef.col = "black", tl.srt = 15, tl.cex = 0.6, number.cex = 0.7)
# Computing the mutual information using python
mtrain_data <- as.matrix(train_data, dimnames=NULL)
mutinf <- sklearn1$mutual_info_classif(mtrain_data, mtrain_data[,1])
mutinf
mutinf <- sklearn1$mutual_info_classif(mtrain_data, mtrain_data[,37])
mutinf
